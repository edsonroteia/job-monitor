<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Job Monitor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<header>
  <div class="header-left">
    <h1>Job Monitor <span class="live-dot" id="live-dot" title="Auto-refresh active"></span></h1>
    <div class="greeting" id="greeting"></div>
    <div class="last-updated" id="last-updated"></div>
  </div>
  <div class="controls">
    <input type="text" id="name-filter" placeholder="Filter by job name..." oninput="applyNameFilter()">
    <button class="col-toggle-btn" id="col-toggle-btn" onclick="toggleAllColumns()" title="Show all table columns"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect></svg>All cols</button>
    <button id="refresh-btn" onclick="fetchJobs()" title="Refresh"><svg class="refresh-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg></button>
    <button id="config-btn" onclick="showConfigModal()" title="Settings">âš™</button>
  </div>
</header>

<div id="content">
  <p style="color:var(--text-2);text-align:center;padding:2rem 0;">Connecting to servers&hellip;</p>
</div>

<div class="modal-overlay" id="modal-overlay" onclick="closeModal(event)">
  <div class="modal">
    <div class="modal-header">
      <h3 id="modal-title">Job Output</h3>
      <button class="modal-close" onclick="closeModal()">&times;</button>
    </div>
    <div class="modal-body" id="modal-body"></div>
  </div>
</div>

<div class="modal-overlay" id="config-overlay" onclick="closeConfigModal(event)">
  <div class="modal config-modal">
    <div class="modal-header">
      <h3>Settings</h3>
      <button class="modal-close" onclick="closeConfigModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="config-section">
        <label class="config-label" for="config-refresh-interval">Auto-refresh interval:</label>
        <select id="config-refresh-interval" class="config-input">
          <option value="0">Off</option>
          <option value="5">5 seconds</option>
          <option value="10">10 seconds</option>
          <option value="30">30 seconds</option>
          <option value="60">60 seconds</option>
        </select>
      </div>
      <div class="config-section">
        <label class="config-label" for="config-timestamp-format">Timestamp format:</label>
        <select id="config-timestamp-format" class="config-input">
          <option value="absolute">Absolute (2025-02-15T14:30:00)</option>
          <option value="relative">Relative (2h30m ago)</option>
        </select>
      </div>
      <div class="config-section">
        <label class="config-label" for="config-cluster-timezone">Cluster timezone:</label>
        <select id="config-cluster-timezone" class="config-input">
          <option value="UTC">UTC</option>
          <option value="Europe/Berlin">Europe/Berlin (CET/CEST)</option>
          <option value="Europe/London">Europe/London (GMT/BST)</option>
          <option value="Europe/Paris">Europe/Paris (CET/CEST)</option>
          <option value="Europe/Zurich">Europe/Zurich (CET/CEST)</option>
          <option value="America/New_York">America/New_York (EST/EDT)</option>
          <option value="America/Chicago">America/Chicago (CST/CDT)</option>
          <option value="America/Denver">America/Denver (MST/MDT)</option>
          <option value="America/Los_Angeles">America/Los_Angeles (PST/PDT)</option>
          <option value="Asia/Tokyo">Asia/Tokyo (JST)</option>
          <option value="Asia/Shanghai">Asia/Shanghai (CST)</option>
          <option value="Australia/Sydney">Australia/Sydney (AEST/AEDT)</option>
        </select>
        <div class="config-hint">Timezone of the SLURM cluster. Timestamps will be converted to your local time.</div>
      </div>
      <div class="config-section">
        <label class="config-label" for="config-recent-count">Number of recent jobs to display:</label>
        <input type="number" id="config-recent-count" class="config-input" min="1" max="50" value="5">
        <div class="config-hint">Show between 1 and 50 recently finished jobs per server</div>
      </div>
      <div class="config-error" id="config-error"></div>
      <div class="config-actions">
        <button class="config-save-btn" onclick="saveConfig()">Save</button>
        <button class="config-cancel-btn" onclick="closeConfigModal()">Cancel</button>
      </div>
    </div>
  </div>
</div>

<script src="/static/app.js"></script>
</body>
</html>
